---
title: "[Crypto] Modern Cryptology Study weak 2"
date: 2021-07-19T17:37:28+09:00
categories:
- Crypto
tags:
- crp
keywords:
- tech
#thumbnailImage: //example.com/image.jpg
---

<!--more-->

원동호 저자의 현대 암호학 (제 6판)을 읽고 정리한 글입니다.  
교재 정보 : [Book](http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&mallGb=KOR&barcode=9788957273050&orderClick=LAG&Kc= "교재 정보")  
정리 분량 : p.25 ~ 42

### 2.1 정수 집합
#### 2.1.1 연산의 기본 성질

정수 집합 Z 위에서는 덧셈과 곱셈이 성립하며 몇 가지 성질을 갖는다.

> Z1. 덧셈이 정의된다.  
Z2. 덤셈에 대하여 교환 법칙이 성립된다.  
Z3. 덧셈에 대하여 결합 법칙이 성립된다.  
Z4. 덧셈에 대한 항등원(Identity)은 정수 0이다.  
Z5. 집합 Z에는 a∈Z의 역원(Inverse)인 -a∈Z가 존재한다. 따라서 뺄셈도 정의된다.  
Z6. 곱셈이 정의된다.
Z7. 곱셈에 대하여 교환 법칙이 성립된다.  
Z8. 곱셈에 대하여 결합 법칙이 성립된다.  
Z9. 곱셉에 대한 항등원(Identity)은 정수 1이다.  
Z10. 덧셈과 곱셈은 분배 법칙이 성립된다.

곱셈은 1과 -1만이 역원을 갖는다. 따라서 정수 집합 Z 위에서는 나눗셈이 정의되지 않는다.  

### 2.2 약수와 배수

집합 Z 위의 정수 a 와 b가 b = c * a를 만족하는 정수 c가 존재할 때,  
a는 b의 약수(divisor)라고 하며, b를 a의 배수라고 한다.
> a | b ( a는 b를 나눈다. or b는 a로 나누어 떨어진다. )

---

> d | a, d | b

위와 같은 정수 d를 a와 b의 공약수(common divisor)라고 한다.  
a와 b의 공약수 중에서 가장 큰 공약수를 최대 공약수(gcd : greatest common divisor)라고 한다.  

#### 2.2.1 유클리드 호제법 (Euclidean algorithm)

두 양의 정수 a, b의 최대 공약수를 구하는 알고리즘이다.  
a를 b로 나눈 나머지를 r이라고 할 때, a와 b의 gcd는 b와 r의 gcd와 같다.  
이런 성질을 이용한 알고리즘으로 b를 r로 나눈 나머지 r1을 구하고  
다시 r을 r1으로 나눈 나머지를 구하는 과정을 반복한다.  
나머지가 0이 되었을 때, 나누는 수가 a와 b의 gcd이다.  

참조 : [Wiki](https://ko.wikipedia.org/wiki/%EC%9C%A0%ED%81%B4%EB%A6%AC%EB%93%9C_%ED%98%B8%EC%A0%9C%EB%B2%95 "wiki")

이에 대한 예제로 510과 62의 gcd를 구해보자.

510 = 62 * 8 + 14  
62 = 14 * 4 + 6  
14 = 6 * 2 + 2  
6 = 2 * 3 + 0  

이를 통해 510과 62의 gcd는 2라는 것을 알 수 있다.

### 2.3 소수

> 소수 : 1과 자기 자신 이외의 약수가 존재하지 않는 양의 정수  
> 합성수 : 소수가 아닌 정수

정수 n은 유일한 소수의 곱으로 표시된다.  
이를 n의 표준 분해라고 한다. ( 추후 보충 예정 )

#### 2.3.1 소수의 분포

양의 정수 중에 소수는 무한히 많다.  
양의 정수 x를 임의로 선택할 때, x안에 분포하는 소수의 개수를 π(x)라고 하며 그 값은 x/ln x로써 표기된다.  

##### (1) Mersenne 소수  
양정수 중에 2^p - 1의 형태로 표시되는 수를 Mersenne 수라고 한다.  
이중에서 소수를 Mersenne 소수라고 한다.  
Mersenne 소수가 되려면 p는 소수여야 한다.  
그 역은 성립 불가  

##### (2) Fermat의 수
2^2^n - 1의 모양의 수를 Fermat의 수라고 한다.  
이 중 소수를 Fermat의 소수라고 한다.  

##### (3) Carmichael 수
gcd(a,n) ≡ 1인 모든 a에 대하여 a^p-1 ≡ 1 mod p이 성립된다.  
이는 Fermat의 소정리에 의한 것이다.  

##### (4) 소수 판정법
소수 판별법에는 결정적 판정방법과 확률적 판정방법이 존재한다.  

결정적 소수 판정법은 정확도는 높으나 시간이 오래 소모된다.  
( Euclid 호제법, Fermat의 방법, Wilson 방법, etc.. )

확률적 소수 판정법은 정확성은 결정적 방식에 비해 낮지만 소모되는 시간이 짧다.  
대부분 이 방법을 이용한다.  
( Solovay - Strassen 방법, Lehmann - Peralta 방법, etc.. )

### 2.4 합동식

a-b가 m의 배수일 때, a와 b는 법(modulus) m에 관한 합동이라고 한다.  
> a ≡ b mod m

합동은 상등, 상이, 대등 등의 관계가 존재하며,  
세 가지의 성질을 갖는다.  
> a ≡ a mod m (반사적)  
a ≡ b mod m 이면 b ≡ a mod m (대칭적)  
a ≡ b mod m, b ≡ c mod m 이면 a ≡ c mod m (추이적)  

#### 2.4.1 법 m에 관한 잉여계

a ≡ b mod m은 정수 전체 집합 Z 위에서 동치 관계이다.  
(합동의 세 가지 성질을 갖기 때문에)

a ≡ b mod m에 대한 정수 집합 Z위의 동치류를 법 m에 대한 잉여류(Residue)라고 한다.
a∈Z에 의해 만들어진 잉여류를 (a-)로 표시하면 ( 추후 수정 )  
>A ≡ { x∈Z | x ≡ a mod m }  

으로 표시된다.  
즉, 합동 관계 a ≡ b mod m에 의하여 정수 집합 Z가 m개의 잉여류들로 분할(Partition)된다.

Zm = { 0, 1, 2, ... m-1}을 법 m에 관한 완전 잉여계(Complete residue system)라 하고,  
각 잉여류의 대표원(representive)이라 한다.  

Zm 집합 원소 중에서 m과 서로소인 원소 전체 집합을 Zm*로 표시하며  
이를 법 m에 관한 기약 잉여계(Reduced residue system)라고 한다.  
Zm* 집합의 원소 개수는 φ(m)으로 나타낸다.

φ(m)은 Euler의 φ함수(φ-function)라고 한다.  
p가 소수일 경우  
> zp* = { 1, 2, ..., p-1 }, φ(p) = p - 1 

또한, gcd(a,m) = 1을 만족하는 양의 정수 a를 곱합 R = { ar1, ar2, ... arφ(m)}도 기약 잉여계이다.

#### 2.4.2 Euler의 정리

위의 서술한 집합 R이 기약 잉여계이므로 법 m에 대한 다음 식이 성립된다.  
> ar1 * ar2 * ar3 * ... * arφ(m) ≡ r1 * r2 * r3 ... * rφ(m) mod m  
a^φ(m) * r1 * r2 * r3 ... * rφ(m) ≡ r1 * r2 * r3 * ... * rφ(m) mod m

따라서 a^φ(m) ≡ 1 mod m이다.  
이를 Euler의 정리라고 한다.

Euler의 정리에서 Zm의 m이 소수 p인 경우 gcd(a,p) = 1에 대하여 φ(p) = p - 1이므로  
> a^(p-1) ≡ 1 mod p

가 성립된다. 이를 Fermat의 소정리라고 한다.  
p가 소수일 때, a∈Z에 대하여  
> a^p = a mod p

가 성립된다.

일차 합동식  
> ax ≡ b mod m

이 정수 a와 m이 서로소이면 x는 단 하나의 해를 갖는다.  
따라서 p가 소수일 때 일차 합동식  
> ax ≡ b mod p

는 단 한개의 해를 갖는다.

a와 m이 서로소이므로 au + mv = 1인 정수 u, v가 존재한다. 이 때,  
> a(ub) + m(vb) = b

이므로 a(ub) ≡ b mod m이 성립하고,  
x ≡ ub mod m은  주어진 합동식의 해가 된다.  

### 2.5 원시근

#### 2.5.1 위수

Euler의 정리로부터 정수 a∈Z가 법 m과 서로소이면 a^φ(m) ≡ 1 mod m이다.  
마찬가지로 정수 b∈Z와 m이 서로소이면  
> b^r ≡ 1 mod m

을 만족시키는 양의 정수 r이 존재하게 된다.  
가장 작은 r을 법 m에 대한 b의 위수(order)이라고 한다.  
[ r | φ(m)이 성립된다. ]

예제를 보고 이해해보자.  
> 예제 : m = 15일 때 원소들의 위소를 구해 보자.

법 m = 15의 위수
||||
|------|---|---|
|정수|위수|
|1|1|
|2|4|
|4|2|
|7|4|
|8|4|
|11|2|
|13|4|
|14|2|

법 m = 15에 관한 기약 잉여계의 각 원소에 대한 위수는 위와 같다.  
하지만 φ(15)가 존재하지 않는다. 즉, Z15 위에서는 원시근이 존재하지 않는다.

#### 2.5.2 원시근

앞서 말한 예제에서 위수값 φ(15) = 8인 원소가 존재하지 않는다고 했다.  
법 m에 관한 정수 g의 위수가 φ(m)일 때, g를 법 m에 대한 원시근(Primitive root)라고 한다.  
[ 혹은 원시원소 (Primitive element) ]

예제로 이해해보자.  
법 m = 14에 대한 Euler 함수 φ(14) = 6이고  
기약 잉여계 Z14* = { 1, 3, 5, 9, 11, 13 }는 원시근을 존재하는가?

 법 m = 14의 위수
||||
|------|---|---|
|정수|위수|
|1|3|
|3|6|
|5|6|
|9|3|
|11|3|
|13|2|

위 표를 보면 3과 5는 법 m = 14에 관한 원시근이다.  
원시근의 누승 { 3^1, 3^2, 3^3, 3^4, 3^5, 3^6 }과  
{ 5^1, 5^2, 5^3, 5^4, 5^5, 5^6 }은 법 m = 14에 관한 기약 잉여계 Z14*가 된다.  

또, 법 p의 p가 소수일 때의 원시근을 g라고 하면 항상 다음식이 성립된다.  
> g^((p-1)/2) ≡ -1 mod p

#### 2.5.3 이산 대수

양의 정수 m을 법으로 갖는 법 m의 원시근을 g라고 하면  
> { g^1, g^2, g^3, ... , g^φ(m) }

은 법 m에 관한 기약 잉여계가 된다.

따라서 gcd(a,m) = 1인 정수 a에 대하여  
> a ≡ g^i mod m

인 정수 i가 단 하나 존재한다.  
즉, 정수 m을 법으로 구성되는 집합 Zm이 원시근 g를 가질 때  
gcd(a,m) = 1인 a에 대하여  
> a ≡ g^i mod m

인 i를 법 m에 관한 g를 밑으로 갖는 a의 이산 대수(Discrete logarithm)라 한다.  
이를 log g a로 나타낸다.




